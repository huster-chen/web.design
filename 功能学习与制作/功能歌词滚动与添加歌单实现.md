歌词滚动已经实现
添加歌单模拟类似于添加购物车
正好把这个添加购物车实战做完然后再继续恶补JS
然后稍稍学习一下Vue实现一下页面框架与交互
目前的状态功能基本完事，先进行磨合与恶补（真的好需要恶补啊）
![[Pasted image 20240323003113.png]]![[Pasted image 20240323003129.png]]

大佬用到了面向对象的思想。。。慢慢来吧
```
//单间商品的数据

class UIGoods {

constructor(g) {

this.data = g;

this.choose = 0;

}

  

//获取总价

getTotalPrice () {

return this.data.price * this.choose;

}

//是否选中了此件商品

  

isChoose () {

return this.choose > 0;

}

//选择的数量加一

increase()

{

this.choose++;

}

//选择的数量减一

decrease() {

if (this.choose === 0)

{

return;

}

this.choose --;

}

  

}

//整个界面的数据

class UIData{

constructor() {

var uiGoods = []

for (var i = 0; i < goods.length; i++){

var uig = new UIGoods(goods[i]);

uiGoods.push(uig);

}

this.uiGoods = uiGoods;

this.deliveryThreshold = 30;

this.deliveryPrice = 5;

}

getTotalPrice() {

var sum = 0;

for (var i = 0; i < this.uiGoods.length; i++){

var g = this.uiGoods[i];

sum+=g.getTotalPrice();

}

return sum;

}

//增加某件商品的选中数量

increase(index) {

this.uiGoods[index].increase();

}

  
  
  

decrease(index) {

this.uiGoods[index].decrease();

}

//得到总共的选择数量

getTotalChooseNumber() {

var sum = 0;

for (var i = 0; i < this.uiGoods.length; i++){

sum += this.uiGoods[i].choose;

}

return sum;

}

  

//购物车中有没有东西

hasGoodsInCar() {

return this.getTotalChooseNumber() > 0;

}

isCrossDeliveryThreshold() {

return this.getTotalPrice() >= this.deliveryThreshold;

}

  

// 购物车有没有选中

isChoose(index)

{

return this.uiGoods[index].isChoose();

}

  

}

  

//整个界面

class UI {

constructor() {

this.uiData = new UIData();

this.doms = {

goodsContainer: document.querySelector('.goods-list'),

deliveryPrice: document.querySelector('.footer-car-tip'),

footerPay: document.querySelector('.footer-pay'),

footerPayInnerSpan: document.querySelector('.footer-pay span'),

totalPrice: document.querySelector('.footer-car-total'),

car: document.querySelector('.footer-car'),

badge:document.querySelector('.footer-car-badge'),

};

  
  

var carRect = this.doms.car.getBoundingClientRect();

  

var jumpTarget = {

x: carRect.left + carRect.width / 2,

y: carRect.top + carRect.height / 5,

};

this.jumpTarget = jumpTarget;

this.createHTML();

this.updataFooter();

this.listenEvent();

}

  
  

//监听各种事件

listenEvent() {

this.doms.car.addEventListener('animationend', function () {

this.classList.remove('animate');

});

}

// 根据商品数据创建商品列表的元素

createHTML() {

var html = '';

for (var i = 0; i < this.uiData.uiGoods.length; i++) {

var g = this.uiData.uiGoods[i];

console.log(g);

html += `<div class="goods-item">

<img src="${g.data.pic}" alt="" class="goods-pic" />

<div class="goods-info">

<h2 class="goods-title">${g.data.title}</h2>

<p class="goods-desc">

${g.data.desc}

</p>

<p class="goods-sell">

<span>月售 ${g.data.sellNumber}</span>

<span>好评率${g.data.favorRate}</span>

</p>

<div class="goods-confirm">

<p class="goods-price">

<span class="goods-price-unit">￥</span>

<span>${g.data.price}</span>

</p>

<div class="goods-btns">

<i index="${i}" class="iconfont i-jianhao"></i>

<span>${g.data.choose}</span>

<i index="${i}" class="iconfont i-jiajianzujianjiahao"></i>

</div>

</div>

</div>

</div>`;

}

this.doms.goodsContainer.innerHTML = html;

}

increase(index) {

this.uiData.increase(index);

this.updateGoodsItem(index);

this.updataFooter();

this.jump(index);

}

decrease(index) {

this, this.uiData.decrease(index);

this.updateGoodsItem(index);

this.updataFooter();

}

//更新某个商品元素的显示状态

updateGoodsItem(index) {

var goodsDom = this.doms.goodsContainer.children[index];

if (this.uiData.isChoose(index)) {

goodsDom.classList.add('active');

}

else {

goodsDom.classList.remove('active');

}

var span = goodsDom.querySelector('.goods-btns span')

span.textContent = this.uiData.uiGoods[index].choose;

}

//更新页脚

updataFooter() {

//得到总价数据

var total = this.uiData.getTotalPrice()

//设置配送费

this.doms.deliveryPrice.textContent = `配送费￥${this.uiData.deliveryPrice}`;

//设置起送费还差多少

if (this.uiData.isCrossDeliveryThreshold()) {

this.doms.footerPay.classList.add('active');

}else {

this.doms.footerPay.classList.remove('active');

var dis = this.uiData.deliveryThreshold - total;

dis = Math.round(dis);

this.doms.footerPayInnerSpan.textContent=`还差￥${dis}元起送`

}

  

//设置总价

this.doms.totalPrice.textContent = total.toFixed(2);

//设置购物车的状态

if (this.uiData.hasGoodsInCar())

{

this.doms.car.classList.add('active');

}

else {

this.doms.car.classList.remove('active');

}

//设置购物车的数量

this.doms.badge.textContent = this.uiData.getTotalChooseNumber();

}

//购物车动画

carAnimate() {

this.doms.car.classList.add('animate');

}

  

//抛物线跳跃的元素

jump(index) {

var btnAdd=this.doms.goodsContainer.children[index].querySelector('.i-jiajianzujianjiahao');

var rect = btnAdd.getBoundingClientRect();

var start = {

x: rect.left,

y: rect.top,

};

//跳吧

var div = document.createElement('div');

div.className = 'add-to-car';

var i = document.createElement('i');

i.className= 'iconfont i-jiajianzujianjiahao';

//设置初始位置

div.style.transform = `translateX(${start.x}px)`;

i.style.transform = `translateY(${start.y}px)`;

div.appendChild(i)

document.body.appendChild(div)

//强行渲染

div.clientWidth;

  
  

// console.log(start,this.jumpTarget)

  

//设置结束位置

div.style.transform = `translateX(${this.jumpTarget.x}px)`;

i.style.transform = `translateY(${this.jumpTarget.y}px)`;

var that = this;

div.addEventListener(

'transitionend',

function () {

div.remove();

that.carAnimate();

  

},

{

once:true,//事件仅触发一次

}

  

)

  

}

}

  

var ui = new UI()

// console.log(ui);

  
  

//事件

ui.doms.goodsContainer.addEventListener('click', function (e)

{

if (e.target.classList.contains('i-jiajianzujianjiahao')) {

var index = +e.target.getAttribute('index');

ui.increase(index);

} else if (e.target.classList.contains('i-jianhao')) {

console.log('减号');

var index = +e.target.getAttribute('index');

ui.decrease(index);

}

  

})
```